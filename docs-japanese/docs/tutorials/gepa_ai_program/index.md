# GEPAによるリフレクティブ・プロンプト進化

本節では、DSPy向けのリフレクティブ・プロンプト最適化手法であるGEPAを紹介する。GEPAは、LM（大規模言語モデル）がDSPyプログラムの実行過程を内省する能力を活用し、成功した点・失敗した点・改善可能な点を特定することで機能する。この内省結果に基づき、GEPAは新たなプロンプトを提案し、進化させたプロンプト候補のツリー構造を構築しながら、最適化の進行に伴って段階的な改善を蓄積していく。GEPAはドメイン固有のテキストフィードバック（スカラー指標のみに依存しない）を利用できるため、わずか数回のロールアウトで高性能なプロンプトを提案できる場合が多い。GEPAは論文[GEPA: リフレクティブ・プロンプト進化は強化学習を凌駕する](https://arxiv.org/abs/2507.19457)で発表され、`dspy.GEPA`として実装されている。この実装は[gepa-ai/gepa](https://github.com/gepa-ai/gepa)で公開されているGEPA実装を内部的に利用している。

## `dspy.GEPA` チュートリアル

### [GEPAによるAIME（数学）問題への適用](../gepa_aime/index.ipynb)
本チュートリアルでは、GEPAが単一の`dspy.ChainOfThought`ベースプログラムを最適化することで、GPT-4.1 Miniを用いてAIME 2025において10%の性能向上を達成する方法について解説する。

### [企業向け構造化情報抽出タスクにおけるGEPAの活用](../gepa_facilitysupportanalyzer/index.ipynb)
本チュートリアルでは、GEPAが予測器レベルのフィードバックを活用することで、GPT-4.1 Nanoの企業環境における構造化情報抽出および分類タスクにおける性能を向上させる手法について詳述する。

### [プライバシー保護を考慮した委任タスクにおけるGEPAの適用](../gepa_papillon/index.ipynb)
本チュートリアルでは、GEPAがLLM-as-a-judge指標が提供するシンプルなフィードバックを活用しながら、わずか1回の反復で迅速に性能向上を達成できる方法について解説する。さらに、GEPAが集計指標をサブコンポーネントに分解したテキストフィードバックを利用することで、リフレクションLMがタスクのどの側面を改善すべきかを特定できる仕組みについても説明する。

### [GEPAを用いたコードバックドア分類（AI制御）](../gepa_trusted_monitor/index.ipynb)
本チュートリアルでは、`dspy.GEPA`と比較評価指標を活用することで、GPT-4.1 Nanoベースの分類器を最適化し、大規模言語モデル（LM）によって生成されたコード内に存在するバックドアを検出する手法について解説します。比較評価指標を用いることで、プロンプト最適化アルゴリズムがコード中のバックドア存在を示す特徴的な信号を抽出し、正例サンプルと負例サンプルを明確に区別可能なプロンプトを生成できるようになります。
