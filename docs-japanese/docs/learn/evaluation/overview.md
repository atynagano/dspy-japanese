---
sidebar_position: 1
---

# DSPyにおける評価手法

初期システムを構築したら、**初期開発用データセット**を収集し、より体系的な改良を行う段階に入ります。タスクの入力例が20件程度でも有用ですが、200件あればさらに効果的です。使用する評価指標によっては、入力データのみでラベルが不要の場合もあれば、入力データに加えてシステムの最終出力が必要となる場合もあります。（DSPyでは、プログラムの中間処理段階におけるラベルはほとんど必要ありません。）HuggingFaceのデータセットや、StackExchangeなどの自然発生的な情報源から、タスクに隣接するデータセットを見つけることが可能です。データの使用ライセンスが許容範囲内であれば、それらのデータを活用することをお勧めします。そうでない場合は、少数の例を手作業でラベル付けするか、システムのデモ展開を開始して初期データを収集する方法があります。

次に、**DSPy用の評価指標**を定義する必要があります。システムの出力が優れているか劣っているかを判断するための基準を明確にしましょう。評価指標の定義とその継続的な改善に投資することが重要です。定義できない要素を改善し続けることは困難だからです。評価指標とは、データセットから抽出した事例とシステムの出力を入力として受け取り、スコアを返す関数です。単純なタスクの場合、例えば単純な分類問題や短文形式の質問応答タスクでは「正解率」といった単純な指標で十分な場合があります。しかしほとんどの応用ケースでは、システムは長文形式の出力を生成するため、評価指標は出力の複数の特性を検証するより複雑なDSPyプログラムとなります。最初の試みで最適な指標を設計できる可能性は低いため、まずはシンプルな指標から始め、反復的に改善していくアプローチが有効です。

データと評価指標が揃ったら、パイプライン設計の開発評価を実施し、そのトレードオフを理解します。出力結果と評価指標スコアを詳細に分析してください。これにより、重大な問題を早期に発見できるだけでなく、今後の開発におけるベースライン指標を設定することが可能になります。


??? "評価指標自体がDSPyプログラムである場合..."
    評価指標自体がDSPyプログラムである場合、強力な改善手法として評価指標そのものの最適化が挙げられます。これは通常容易な作業です。なぜなら評価指標の出力は通常単純な値（例えば5段階評価のスコアなど）であるため、評価指標自体の評価指標を定義し最適化することは、少数の事例を収集することで比較的簡単に行えるからです。

