
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The framework for programming—rather than prompting—language models.">
      
      
      
        <link rel="canonical" href="https://atynagano.github.io/dspy-japanese/api/optimizers/GEPA/overview/">
      
      
        <link rel="prev" href="../../../modules/Refine/">
      
      
        <link rel="next" href="../GEPA_Advanced/">
      
      
        
      
      
      <link rel="icon" href="../../../../static/img/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>1. GEPA Overview - DSPy 日本語ドキュメント</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-G728W2L8KQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-G728W2L8KQ');
</script>

  
<meta property="og:type" content="website" />
<meta property="og:title" content="1. GEPA Overview - DSPy 日本語ドキュメント" />
<meta property="og:description" content="The framework for programming—rather than prompting—language models." />
<meta property="og:image" content="https://atynagano.github.io/dspy-japanese/assets/images/social/api/optimizers/GEPA/overview.png" />
<meta property="og:image:type" content="image/png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:url" content="https://atynagano.github.io/dspy-japanese/api/optimizers/GEPA/overview/" />
<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:title" content="1. GEPA Overview - DSPy 日本語ドキュメント" />
<meta property="twitter:description" content="The framework for programming—rather than prompting—language models." />
<meta property="twitter:image" content="https://atynagano.github.io/dspy-japanese/assets/images/social/api/optimizers/GEPA/overview.png" />
</head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="black">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dspygepa" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="DSPy 日本語ドキュメント" class="md-header__button md-logo" aria-label="DSPy 日本語ドキュメント" data-md-component="logo">
      
  <img src="../../../../static/img/dspy_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DSPy 日本語ドキュメント
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              1. GEPA Overview
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="black"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/atynagano/dspy-japanese" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    atynagano/dspy-japanese
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            <!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->



<!-- Navigation tabs -->
<nav
  class="md-tabs"
  aria-label="Tabs"
  data-md-component="tabs"
>
  <div class="md-tabs__inner md-grid">

	<!-- Adds tab on right side of header -->
	
        <ul class="md-tabs__list" style="float: right;">
            <li class="md-tabs__item">
                <a href="/production/" class="md-tabs__link">
                    DSPy in Production
                </a>
            </li>
	    <li class="md-tabs__item">
                <a href="/community/community-resources/" class="md-tabs__link">
                    Community
                </a>
            </li>
            <li class="md-tabs__item">
                <a href="/faqs/" class="md-tabs__link">
                    FAQ
                </a>
            </li>
        </ul>
	

	<!-- Original tabbed sections -->
	<ul class="md-tabs__list">
	  
		
            
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Get Started

      </a>
    </li>
  

		
	  
		
            
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../learn/" class="md-tabs__link">
          
  
  
    
  
  Learn DSPy

        </a>
      </li>
    
  

		
	  
		
            
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../tutorials/" class="md-tabs__link">
          
  
  
    
  
  Tutorials

        </a>
      </li>
    
  

		
	  
		
	  
		
	  
		
	  
		
            
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

		
	  
	</ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="DSPy 日本語ドキュメント" class="md-nav__button md-logo" aria-label="DSPy 日本語ドキュメント" data-md-component="logo">
      
  <img src="../../../../static/img/dspy_logo.png" alt="logo">

    </a>
    DSPy 日本語ドキュメント
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/atynagano/dspy-japanese" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    atynagano/dspy-japanese
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Get Started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../learn/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Learn DSPy
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Learn DSPy
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    DSPy Programming
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    DSPy Programming
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../learn/programming/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Programming Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../learn/programming/language_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Language Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../learn/programming/signatures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Signatures
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../learn/programming/modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Modules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../learn/programming/adapters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adapters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../learn/programming/tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../learn/programming/mcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MCP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    DSPy Evaluation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    DSPy Evaluation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../learn/evaluation/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluation Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../learn/evaluation/data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Handling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../learn/evaluation/metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    DSPy Optimization
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    DSPy Optimization
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../learn/optimization/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Optimization Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../learn/optimization/optimizers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Optimizers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../tutorials/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../tutorials/build_ai_program/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Build AI Programs with DSPy
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Build AI Programs with DSPy
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/conversation_history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Managing Conversation History
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/customer_service_agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Building AI Agents with DSPy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/custom_module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Building AI Applications by Customizing DSPy Modules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/rag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Retrieval-Augmented Generation (RAG)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Building RAG as Agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/entity_extraction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Entity Extraction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/classification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Classification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/multihop_search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-Hop RAG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/papillon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Privacy-Conscious Delegation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/program_of_thought/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Program Of Thought
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/image_generation_prompting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Image Generation Prompt iteration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/audio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Audio
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../tutorials/optimize_ai_program/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Optimize AI Programs with DSPy
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Optimize AI Programs with DSPy
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/math/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Math Reasoning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/classification_finetuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Classification Finetuning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/tool_use/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Tool Use
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/games/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Finetuning Agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../tutorials/gepa_ai_program/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Reflective Prompt Evolution with dspy.GEPA
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reflective Prompt Evolution with dspy.GEPA
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/gepa_aime/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GEPA for AIME (Math)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/gepa_facilitysupportanalyzer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GEPA for Structured Information Extraction for Enterprise Tasks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/gepa_papillon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GEPA for Privacy-Conscious Delegation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/gepa_trusted_monitor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GEPA for Code Backdoor Classification (AI control)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../tutorials/rl_ai_program/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Experimental RL Optimization for DSPy
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Experimental RL Optimization for DSPy
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/rl_papillon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RL for Privacy-Conscious Delegation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/rl_multihop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RL for Multi-Hop Research
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../tutorials/core_development/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Tools, Development, and Deployment
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tools, Development, and Deployment
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/mcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Use MCP in DSPy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/output_refinement/best-of-n-and-refine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Output Refinement
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/saving/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Saving and Loading
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/cache/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cache
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deployment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/observability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Debugging & Observability
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/optimizer_tracking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tracking DSPy Optimizers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Streaming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/async/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Async
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../tutorials/real_world_examples/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Real-World Examples
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Real-World Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/llms_txt_generation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generating llms.txt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/mem0_react_agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Memory-Enabled ReAct Agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/yahoo_finance_react/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Financial Analysis with Yahoo Finance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/email_extraction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Email Information Extraction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/sample_code_generation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code Generation for Unfamiliar Libraries
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/ai_text_game/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Building a Creative Text-Based AI Game
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../production/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DSPy in Production
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Community
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Community
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../community/community-resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Community Resources
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../community/use-cases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Use Cases
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../community/how-to-contribute/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    FAQ
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../faqs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cheatsheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cheatsheet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Adapters
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Adapters
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../adapters/Adapter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adapter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../adapters/ChatAdapter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ChatAdapter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../adapters/JSONAdapter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JSONAdapter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../adapters/TwoStepAdapter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TwoStepAdapter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Evaluation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Evaluation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../evaluation/CompleteAndGrounded/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CompleteAndGrounded
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../evaluation/Evaluate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../evaluation/EvaluationResult/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    EvaluationResult
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../evaluation/SemanticF1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SemanticF1
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../evaluation/answer_exact_match/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    answer_exact_match
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../evaluation/answer_passage_match/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    answer_passage_match
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_4" >
        
          
          <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Experimental
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Experimental
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../experimental/Citations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Citations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../experimental/Document/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Document
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../models/Embedder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Embedder
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../models/LM/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_6" >
        
          
          <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Modules
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Modules
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../modules/BestOfN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BestOfN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../modules/ChainOfThought/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ChainOfThought
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../modules/CodeAct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CodeAct
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../modules/Module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Module
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../modules/MultiChainComparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MultiChainComparison
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../modules/Parallel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Parallel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../modules/Predict/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Predict
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../modules/ProgramOfThought/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ProgramOfThought
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../modules/ReAct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ReAct
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../modules/Refine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Refine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Optimizers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Optimizers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7_1" checked>
        
          
          <label class="md-nav__link" for="__nav_7_7_1" id="__nav_7_7_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    GEPA
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_7_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7_7_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    GEPA
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    1. GEPA Overview
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    1. GEPA Overview
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dspy.GEPA" class="md-nav__link">
    <span class="md-ellipsis">
      
        GEPA
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GEPA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dspy.GEPA-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dspy.teleprompt.gepa.gepa.GEPAFeedbackMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        GEPAFeedbackMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GEPAFeedbackMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dspy.teleprompt.gepa.gepa.GEPAFeedbackMetric-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult" class="md-nav__link">
    <span class="md-ellipsis">
      
        DspyGEPAResult
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DspyGEPAResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        使用例
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="使用例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        推論時検索機能
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gepa" class="md-nav__link">
    <span class="md-ellipsis">
      
        GEPAの動作原理
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GEPAの動作原理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. 内省的プロンプト変異
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 最適化信号としての豊富なテキストフィードバック
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. パレート最適に基づく候補選択
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        アルゴリズムの概要
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        フィードバック指標の実装方法
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="フィードバック指標の実装方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        具体例
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        カスタム指示提案機能の提案
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        関連資料
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../GEPA_Advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. GEPA Advanced
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BetterTogether/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BetterTogether
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BootstrapFewShot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BootstrapFewShot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BootstrapFewShotWithRandomSearch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BootstrapFewShotWithRandomSearch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BootstrapFinetune/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BootstrapFinetune
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BootstrapRS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BootstrapRS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../COPRO/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    COPRO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Ensemble/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ensemble
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../InferRules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    InferRules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../KNN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KNN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../KNNFewShot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KNNFewShot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LabeledFewShot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LabeledFewShot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MIPROv2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MIPROv2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SIMBA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SIMBA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_8" >
        
          
          <label class="md-nav__link" for="__nav_7_8" id="__nav_7_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Primitives
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Primitives
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../primitives/Audio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Audio
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../primitives/Code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../primitives/Example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Example
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../primitives/History/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    History
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../primitives/Image/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Image
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../primitives/Prediction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Prediction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../primitives/Tool/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tool
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../primitives/ToolCalls/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ToolCalls
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_9" >
        
          
          <label class="md-nav__link" for="__nav_7_9" id="__nav_7_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Signatures
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Signatures
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../signatures/InputField/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    InputField
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../signatures/OutputField/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OutputField
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../signatures/Signature/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Signature
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_10" >
        
          
          <label class="md-nav__link" for="__nav_7_10" id="__nav_7_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tools
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/ColBERTv2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ColBERTv2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/Embeddings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Embeddings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/PythonInterpreter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PythonInterpreter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_11" >
        
          
          <label class="md-nav__link" for="__nav_7_11" id="__nav_7_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Utils
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Utils
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/StatusMessage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    StatusMessage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/StatusMessageProvider/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    StatusMessageProvider
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/StreamListener/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    StreamListener
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/asyncify/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    asyncify
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/configure_cache/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    configure_cache
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/disable_litellm_logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    disable_litellm_logging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/disable_logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    disable_logging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/enable_litellm_logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    enable_litellm_logging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/enable_logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    enable_logging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/inspect_history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    inspect_history
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/load/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    load
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/streamify/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    streamify
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../../../.." class="md-path__link">
        
  <span class="md-ellipsis">
    Get Started
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../../../" class="md-path__link">
          
  <span class="md-ellipsis">
    API Reference
  </span>

        </a>
      </li>
    
  

      
        
  
  
    
    
      
  
  
    
    
      <li class="md-path__item">
        <a href="./" class="md-path__link">
          
  <span class="md-ellipsis">
    Optimizers
  </span>

        </a>
      </li>
    
  

    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="./" class="md-path__link">
          
  <span class="md-ellipsis">
    GEPA
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/atynagano/dspy-japanese/blob/main/docs-japanese/docs/api/optimizers/GEPA/overview.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
    </a>
  
  


<h1 id="dspygepa">dspy.GEPA: リフレクティブ・プロンプト最適化アルゴリズム<a class="headerlink" href="#dspygepa" title="Permanent link">&para;</a></h1>
<p><strong>GEPA</strong>（Genetic-Pareto）は、論文「GEPA: Reflective Prompt Evolution Can Outperform Reinforcement Learning」（Agrawal et al., 2025, <a href="https://arxiv.org/abs/2507.19457">arXiv:2507.19457</a>）で提案されたリフレクティブ型の最適化アルゴリズムであり、任意のシステムの_textualコンポーネント_（プロンプトなど）を適応的に進化させる機能を有する。GEPAは評価指標から得られるスカラースコアに加え、ユーザーがテキスト形式のフィードバックを提供することで、最適化プロセスを導くことができる。このテキスト形式のフィードバックにより、GEPAはシステムが特定のスコアを獲得した理由をより明確に把握可能となり、その結果としてスコア向上のための改善点を内省的に特定できる。これにより、GEPAは極めて少ない試行回数で高性能なプロンプトを提案することが可能となる。</p>
<!-- START_API_REF -->


<div class="doc doc-object doc-class">



<h2 id="dspy.GEPA" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>              <code class="highlight language-python"><span class="n">dspy</span><span class="o">.</span><span class="n">GEPA</span><span class="p">(</span><span class="n">metric</span><span class="p">:</span> <span class="n">GEPAFeedbackMetric</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">auto</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;light&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;heavy&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_full_evals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_metric_calls</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">reflection_minibatch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">candidate_selection_strategy</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;pareto&#39;</span><span class="p">,</span> <span class="s1">&#39;current_best&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;pareto&#39;</span><span class="p">,</span> <span class="n">reflection_lm</span><span class="p">:</span> <span class="n">LM</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">skip_perfect_score</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">add_format_failure_as_feedback</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">instruction_proposer</span><span class="p">:</span> <span class="n">ProposalFn</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">component_selector</span><span class="p">:</span> <span class="n">ReflectionComponentSelector</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;round_robin&#39;</span><span class="p">,</span> <span class="n">use_merge</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">max_merge_invocations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">num_threads</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">failure_score</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">perfect_score</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">track_stats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">use_wandb</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">wandb_api_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">wandb_init_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">track_best_outputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">warn_on_score_mismatch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">use_mlflow</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">gepa_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>

<a href="#dspy.GEPA" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="dspy.teleprompt.teleprompt.Teleprompter">Teleprompter</span></code></p>



        <p>GEPA is an evolutionary optimizer, which uses reflection to evolve text components
of complex systems. GEPA is proposed in the paper <a href="https://arxiv.org/abs/2507.19457">GEPA: Reflective Prompt Evolution Can Outperform Reinforcement Learning</a>.
The GEPA optimization engine is provided by the <code>gepa</code> package, available from <a href="https://github.com/gepa-ai/gepa">https://github.com/gepa-ai/gepa</a>.</p>
<p>GEPA captures full traces of the DSPy module's execution, identifies the parts of the trace
corresponding to a specific predictor, and reflects on the behaviour of the predictor to
propose a new instruction for the predictor. GEPA allows users to provide textual feedback
to the optimizer, which is used to guide the evolution of the predictor. The textual feedback
can be provided at the granularity of individual predictors, or at the level of the entire system's
execution.</p>
<p>To provide feedback to the GEPA optimizer, implement a metric as follows:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>def metric(
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    gold: Example,
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    pred: Prediction,
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    trace: Optional[DSPyTrace] = None,
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    pred_name: Optional[str] = None,
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    pred_trace: Optional[DSPyTrace] = None,
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>) -&gt; float | ScoreWithFeedback:
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    &quot;&quot;&quot;
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    This function is called with the following arguments:
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    - gold: The gold example.
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    - pred: The predicted output.
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    - trace: Optional. The trace of the program&#39;s execution.
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    - pred_name: Optional. The name of the target predictor currently being optimized by GEPA, for which 
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>        the feedback is being requested.
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    - pred_trace: Optional. The trace of the target predictor&#39;s execution GEPA is seeking feedback for.
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    Note the `pred_name` and `pred_trace` arguments. During optimization, GEPA will call the metric to obtain
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    feedback for individual predictors being optimized. GEPA provides the name of the predictor in `pred_name`
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    and the sub-trace (of the trace) corresponding to the predictor in `pred_trace`.
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    If available at the predictor level, the metric should return {&#39;score&#39;: float, &#39;feedback&#39;: str} corresponding 
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    to the predictor.
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    If not available at the predictor level, the metric can also return a text feedback at the program level
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    (using just the gold, pred and trace).
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>    If no feedback is returned, GEPA will use a simple text feedback consisting of just the score: 
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>    f&quot;This trajectory got a score of {score}.&quot;
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    &quot;&quot;&quot;
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>    ...
</code></pre></div></p>
<p>GEPA can also be used as a batch inference-time search strategy, by passing <code>valset=trainset, track_stats=True, track_best_outputs=True</code>, and using the
<code>detailed_results</code> attribute of the optimized program (returned by <code>compile</code>) to get the Pareto frontier of the batch. <code>optimized_program.detailed_results.best_outputs_valset</code> will contain the best outputs for each task in the batch.</p>
<p>Example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>gepa = GEPA(metric=metric, track_stats=True)
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>batch_of_tasks = [dspy.Example(...) for task in tasks]
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>new_prog = gepa.compile(student, trainset=trainset, valset=batch_of_tasks)
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>pareto_frontier = new_prog.detailed_results.val_aggregate_scores
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a># pareto_frontier is a list of scores, one for each task in the batch.
</code></pre></div></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            dspy.teleprompt.gepa.gepa.GEPAFeedbackMetric" href="#dspy.teleprompt.gepa.gepa.GEPAFeedbackMetric">GEPAFeedbackMetric</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The metric function to use for feedback and evaluation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>auto</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;light&#39;, &#39;medium&#39;, &#39;heavy&#39;] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The auto budget to use for the run. Options: "light", "medium", "heavy".</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_full_evals</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of full evaluations to perform.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_metric_calls</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of metric calls to perform.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reflection_minibatch_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of examples to use for reflection in a single GEPA step. Default is 3.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>candidate_selection_strategy</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;pareto&#39;, &#39;current_best&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The strategy to use for candidate selection. Default is "pareto", 
which stochastically selects candidates from the Pareto frontier of all validation scores. 
Options: "pareto", "current_best".</p>
              </div>
            </td>
            <td>
                  <code>&#39;pareto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reflection_lm</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="              dspy.LM(model: str, model_type: Literal['chat', 'text', 'responses'] = 'chat', temperature: float | None = None, max_tokens: int | None = None, cache: bool = True, callbacks: list[BaseCallback] | None = None, num_retries: int = 3, provider: Provider | None = None, finetuning_model: str | None = None, launch_kwargs: dict[str, Any] | None = None, train_kwargs: dict[str, Any] | None = None, use_developer_role: bool = False, **kwargs) (dspy.clients.lm.LM)" href="../../../models/LM/#dspy.LM">LM</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The language model to use for reflection. Required parameter. GEPA benefits from 
a strong reflection model. Consider using <code>dspy.LM(model='gpt-5', temperature=1.0, max_tokens=32000)</code> 
for optimal performance.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>skip_perfect_score</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to skip examples with perfect scores during reflection. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>instruction_proposer</code>
            </td>
            <td>
                  <code><span title="gepa.core.adapter.ProposalFn">ProposalFn</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional custom instruction proposer implementing GEPA's ProposalFn protocol.
<strong>Default: None (recommended for most users)</strong> - Uses GEPA's proven instruction proposer from 
the <a href="https://github.com/gepa-ai/gepa">GEPA library</a>, which implements the 
<a href="https://github.com/gepa-ai/gepa/blob/main/src/gepa/core/adapter.py"><code>ProposalFn</code></a>. This default 
proposer is highly capable and was validated across diverse experiments reported in the GEPA 
paper and tutorials.</p>
<p>See documentation on custom instruction proposers 
<a href="https://dspy.ai/api/optimizers/GEPA/GEPA_Advanced/#custom-instruction-proposers">here</a>.</p>
<p><strong>Advanced Feature</strong>: Only needed for specialized scenarios:
- <strong>Multi-modal handling</strong>: Processing dspy.Image inputs alongside textual information
- <strong>Nuanced control over constraints</strong>: Fine-grained control over instruction length, format, 
  and structural requirements beyond standard feedback mechanisms
- <strong>Domain-specific knowledge injection</strong>: Specialized terminology or context that cannot be 
  provided through feedback_func alone
- <strong>Provider-specific prompting</strong>: Optimizations for specific LLM providers (OpenAI, Anthropic) 
  with unique formatting preferences
- <strong>Coupled component updates</strong>: Coordinated updates of multiple components together rather 
  than independent optimization
- <strong>External knowledge integration</strong>: Runtime access to databases, APIs, or knowledge bases</p>
<p>The default proposer handles the vast majority of use cases effectively. Use 
MultiModalInstructionProposer() from dspy.teleprompt.gepa.instruction_proposal for visual 
content or implement custom ProposalFn for highly specialized requirements.</p>
<p>Note: When both instruction_proposer and reflection_lm are set, the instruction_proposer is called 
in the reflection_lm context. However, reflection_lm is optional when using a custom instruction_proposer. 
Custom instruction proposers can invoke their own LLMs if needed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>component_selector</code>
            </td>
            <td>
                  <code><span title="gepa.proposer.reflective_mutation.base.ReflectionComponentSelector">ReflectionComponentSelector</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom component selector implementing the <a href="https://github.com/gepa-ai/gepa/blob/main/src/gepa/proposer/reflective_mutation/base.py">ReflectionComponentSelector</a> protocol,
or a string specifying a built-in selector strategy. Controls which components (predictors) are selected 
for optimization at each iteration. Defaults to 'round_robin' strategy which cycles through components 
one at a time. Available string options: 'round_robin' (cycles through components sequentially), 
'all' (selects all components for simultaneous optimization). Custom selectors can implement strategies 
using LLM-driven selection logic based on optimization state and trajectories. 
See <a href="https://github.com/gepa-ai/gepa/blob/main/src/gepa/strategies/component_selector.py">gepa component selectors</a> 
for available built-in selectors and the ReflectionComponentSelector protocol for implementing custom selectors.</p>
              </div>
            </td>
            <td>
                  <code>&#39;round_robin&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>add_format_failure_as_feedback</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to add format failures as feedback. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_merge</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use merge-based optimization. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_merge_invocations</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of merge invocations to perform. Default is 5.</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_threads</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of threads to use for evaluation with <code>Evaluate</code>. Optional.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>failure_score</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The score to assign to failed examples. Default is 0.0.</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>perfect_score</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum score achievable by the metric. Default is 1.0. Used by GEPA 
to determine if all examples in a minibatch are perfect.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>log_dir</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory to save the logs. GEPA saves elaborate logs, along with all candidate 
programs, in this directory. Running GEPA with the same <code>log_dir</code> will resume the run 
from the last checkpoint.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>track_stats</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return detailed results and all proposed programs in the <code>detailed_results</code> 
attribute of the optimized program. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_wandb</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use wandb for logging. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wandb_api_key</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The API key to use for wandb. If not provided, wandb will use the API key 
from the environment variable <code>WANDB_API_KEY</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wandb_init_kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments to pass to <code>wandb.init</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>track_best_outputs</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to track the best outputs on the validation set. track_stats must 
be True if track_best_outputs is True. The optimized program's <code>detailed_results.best_outputs_valset</code> 
will contain the best outputs for each task in the validation set.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>warn_on_score_mismatch</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GEPA (currently) expects the metric to return the same module-level score when 
called with and without the pred_name. This flag (defaults to True) determines whether a warning is 
raised if a mismatch in module-level and predictor-level score is detected.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The random seed to use for reproducibility. Default is 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gepa_kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(Optional) Additional keyword arguments to pass directly to <a href="https://github.com/gepa-ai/gepa/blob/main/src/gepa/api.py">gepa.optimize</a>.
Useful for accessing advanced GEPA features not directly exposed through DSPy's GEPA interface.</p>
<p>Available parameters:
- batch_sampler: Strategy for selecting training examples. Can be a <a href="https://github.com/gepa-ai/gepa/blob/main/src/gepa/strategies/batch_sampler.py">BatchSampler</a> instance or a string 
  ('epoch_shuffled'). Defaults to 'epoch_shuffled'. Only valid when reflection_minibatch_size is None.
- merge_val_overlap_floor: Minimum number of shared validation ids required between parents before 
  attempting a merge subsample. Only relevant when using <code>val_evaluation_policy</code> other than 'full_eval'. 
  Default is 5.
- stop_callbacks: Optional stopper(s) that return True when optimization should stop. Can be a single 
  <a href="https://github.com/gepa-ai/gepa/blob/main/src/gepa/utils/stop_condition.py">StopperProtocol</a> or a list of StopperProtocol instances. 
  Examples: <a href="https://github.com/gepa-ai/gepa/blob/main/src/gepa/utils/stop_condition.py">FileStopper</a>, 
  <a href="https://github.com/gepa-ai/gepa/blob/main/src/gepa/utils/stop_condition.py">TimeoutStopCondition</a>, 
  <a href="https://github.com/gepa-ai/gepa/blob/main/src/gepa/utils/stop_condition.py">SignalStopper</a>, 
  <a href="https://github.com/gepa-ai/gepa/blob/main/src/gepa/utils/stop_condition.py">NoImprovementStopper</a>, 
  or custom stopping logic. Note: This overrides the default 
  max_metric_calls stopping condition.
- use_cloudpickle: Use cloudpickle instead of pickle for serialization. Can be helpful when the 
  serialized state contains dynamically generated DSPy signatures. Default is False.
- val_evaluation_policy: Strategy controlling which validation ids to score each iteration. Can be 
  'full_eval' (evaluate every id each time) or an <a href="https://github.com/gepa-ai/gepa/blob/main/src/gepa/strategies/eval_policy.py">EvaluationPolicy</a> instance. Default is 'full_eval'.
- use_mlflow: If True, enables MLflow integration to log optimization progress. 
  MLflow can be used alongside Weights &amp; Biases (WandB).
- mlflow_tracking_uri: The tracking URI to use for MLflow (when use_mlflow=True).
- mlflow_experiment_name: The experiment name to use for MLflow (when use_mlflow=True).</p>
<p>Note: Parameters already handled by DSPy's GEPA class will be overridden by the direct parameters 
and should not be passed through gepa_kwargs.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Budget Configuration: Exactly one of <code>auto</code>, <code>max_full_evals</code>, or <code>max_metric_calls</code> must be provided.
The <code>auto</code> parameter provides preset configurations: "light" for quick experimentation, "medium" for
balanced optimization, and "heavy" for thorough optimization.</p>
<p>Reflection Configuration: The <code>reflection_lm</code> parameter is required and should be a strong language model.
GEPA performs best with models like <code>dspy.LM(model='gpt-5', temperature=1.0, max_tokens=32000)</code>.
The reflection process analyzes failed examples to generate feedback for program improvement.</p>
<p>Merge Configuration: GEPA can merge successful program variants using <code>use_merge=True</code>.
The <code>max_merge_invocations</code> parameter controls how many merge attempts are made during optimization.</p>
<p>Evaluation Configuration: Use <code>num_threads</code> to parallelize evaluation. The <code>failure_score</code> and 
<code>perfect_score</code> parameters help GEPA understand your metric's range and optimize accordingly.</p>
<p>Logging Configuration: Set <code>log_dir</code> to save detailed logs and enable checkpoint resuming.
Use <code>track_stats=True</code> to access detailed optimization results via the <code>detailed_results</code> attribute.
Enable <code>use_wandb=True</code> for experiment tracking and visualization.</p>
<p>Reproducibility: Set <code>seed</code> to ensure consistent results across runs with the same configuration.</p>
</details>







                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>dspy/teleprompt/gepa/gepa.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="n">metric</span><span class="p">:</span> <span class="n">GEPAFeedbackMetric</span><span class="p">,</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="c1"># Budget configuration</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="n">auto</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;light&quot;</span><span class="p">,</span> <span class="s2">&quot;medium&quot;</span><span class="p">,</span> <span class="s2">&quot;heavy&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>    <span class="n">max_full_evals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="n">max_metric_calls</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="c1"># Reflection configuration</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="n">reflection_minibatch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="n">candidate_selection_strategy</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;pareto&quot;</span><span class="p">,</span> <span class="s2">&quot;current_best&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pareto&quot;</span><span class="p">,</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="n">reflection_lm</span><span class="p">:</span> <span class="n">LM</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>    <span class="n">skip_perfect_score</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="n">add_format_failure_as_feedback</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>    <span class="n">instruction_proposer</span><span class="p">:</span> <span class="s2">&quot;ProposalFn | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="n">component_selector</span><span class="p">:</span> <span class="s2">&quot;ReflectionComponentSelector | str&quot;</span> <span class="o">=</span> <span class="s2">&quot;round_robin&quot;</span><span class="p">,</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="c1"># Merge-based configuration</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="n">use_merge</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="n">max_merge_invocations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="c1"># Evaluation configuration</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="n">num_threads</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="n">failure_score</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="n">perfect_score</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="c1"># Logging</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="n">track_stats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="n">use_wandb</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="n">wandb_api_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="n">wandb_init_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="n">track_best_outputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>    <span class="n">warn_on_score_mismatch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>    <span class="n">use_mlflow</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>    <span class="c1"># Reproducibility</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>    <span class="c1"># GEPA passthrough kwargs</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="n">gepa_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="p">):</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>            <span class="s2">&quot;GEPA metric must accept five arguments: (gold, pred, trace, pred_name, pred_trace). &quot;</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>            <span class="s2">&quot;See https://dspy.ai/api/optimizers/GEPA for details.&quot;</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">metric_fn</span> <span class="o">=</span> <span class="n">metric</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>    <span class="c1"># Budget configuration</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="k">assert</span> <span class="p">(</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="p">(</span><span class="n">max_metric_calls</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">+</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="p">(</span><span class="n">max_full_evals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">+</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>        <span class="p">(</span><span class="n">auto</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="o">==</span> <span class="mi">1</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>    <span class="p">),</span> <span class="p">(</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="s2">&quot;Exactly one of max_metric_calls, max_full_evals, auto must be set. &quot;</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="sa">f</span><span class="s2">&quot;You set max_metric_calls=</span><span class="si">{</span><span class="n">max_metric_calls</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="sa">f</span><span class="s2">&quot;max_full_evals=</span><span class="si">{</span><span class="n">max_full_evals</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="sa">f</span><span class="s2">&quot;auto=</span><span class="si">{</span><span class="n">auto</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="p">)</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">auto</span> <span class="o">=</span> <span class="n">auto</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_full_evals</span> <span class="o">=</span> <span class="n">max_full_evals</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_metric_calls</span> <span class="o">=</span> <span class="n">max_metric_calls</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>    <span class="c1"># Reflection configuration</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">reflection_minibatch_size</span> <span class="o">=</span> <span class="n">reflection_minibatch_size</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">candidate_selection_strategy</span> <span class="o">=</span> <span class="n">candidate_selection_strategy</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>    <span class="k">assert</span> <span class="n">reflection_lm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">instruction_proposer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="s2">&quot;GEPA requires a reflection language model, or custom instruction proposer to be provided. &quot;</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="s2">&quot;Typically, you can use `dspy.LM(model=&#39;gpt-5&#39;, temperature=1.0, max_tokens=32000)` to get a good reflection model. &quot;</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="s2">&quot;Reflection LM is used by GEPA to reflect on the behavior of the program and propose new instructions, and will benefit from a strong model. &quot;</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="p">)</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">reflection_lm</span> <span class="o">=</span> <span class="n">reflection_lm</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">skip_perfect_score</span> <span class="o">=</span> <span class="n">skip_perfect_score</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">add_format_failure_as_feedback</span> <span class="o">=</span> <span class="n">add_format_failure_as_feedback</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>    <span class="c1"># Merge-based configuration</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">use_merge</span> <span class="o">=</span> <span class="n">use_merge</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_merge_invocations</span> <span class="o">=</span> <span class="n">max_merge_invocations</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>    <span class="c1"># Evaluation Configuration</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">num_threads</span> <span class="o">=</span> <span class="n">num_threads</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">failure_score</span> <span class="o">=</span> <span class="n">failure_score</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">perfect_score</span> <span class="o">=</span> <span class="n">perfect_score</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>    <span class="c1"># Logging configuration</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span> <span class="o">=</span> <span class="n">log_dir</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">track_stats</span> <span class="o">=</span> <span class="n">track_stats</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">use_wandb</span> <span class="o">=</span> <span class="n">use_wandb</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">wandb_api_key</span> <span class="o">=</span> <span class="n">wandb_api_key</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">wandb_init_kwargs</span> <span class="o">=</span> <span class="n">wandb_init_kwargs</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">warn_on_score_mismatch</span> <span class="o">=</span> <span class="n">warn_on_score_mismatch</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">use_mlflow</span> <span class="o">=</span> <span class="n">use_mlflow</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="k">if</span> <span class="n">track_best_outputs</span><span class="p">:</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>        <span class="k">assert</span> <span class="n">track_stats</span><span class="p">,</span> <span class="s2">&quot;track_stats must be True if track_best_outputs is True.&quot;</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">track_best_outputs</span> <span class="o">=</span> <span class="n">track_best_outputs</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>    <span class="c1"># Reproducibility</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">custom_instruction_proposer</span> <span class="o">=</span> <span class="n">instruction_proposer</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">component_selector</span> <span class="o">=</span> <span class="n">component_selector</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">gepa_kwargs</span> <span class="o">=</span> <span class="n">gepa_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">








<h3 id="dspy.GEPA-functions">Functions<a href="#dspy.GEPA-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="dspy.GEPA.auto_budget" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">auto_budget</span><span class="p">(</span><span class="n">num_preds</span><span class="p">,</span> <span class="n">num_candidates</span><span class="p">,</span> <span class="n">valset_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">minibatch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span> <span class="n">full_eval_steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

<a href="#dspy.GEPA.auto_budget" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dspy/teleprompt/gepa/gepa.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="k">def</span><span class="w"> </span><span class="nf">auto_budget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_preds</span><span class="p">,</span> <span class="n">num_candidates</span><span class="p">,</span> <span class="n">valset_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">minibatch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span> <span class="n">full_eval_steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="n">num_trials</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">num_preds</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">num_candidates</span><span class="p">),</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">num_candidates</span><span class="p">))</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="k">if</span> <span class="n">num_trials</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">valset_size</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">minibatch_size</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;num_trials, valset_size, and minibatch_size must be &gt;= 0.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="k">if</span> <span class="n">full_eval_steps</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;full_eval_steps must be &gt;= 1.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="n">V</span> <span class="o">=</span> <span class="n">valset_size</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>    <span class="n">N</span> <span class="o">=</span> <span class="n">num_trials</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>    <span class="n">M</span> <span class="o">=</span> <span class="n">minibatch_size</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="n">m</span> <span class="o">=</span> <span class="n">full_eval_steps</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>    <span class="c1"># Initial full evaluation on the default program</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>    <span class="n">total</span> <span class="o">=</span> <span class="n">V</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="c1"># Assume upto 5 trials for bootstrapping each candidate</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>    <span class="n">total</span> <span class="o">+=</span> <span class="n">num_candidates</span> <span class="o">*</span> <span class="mi">5</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="c1"># N minibatch evaluations</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="n">total</span> <span class="o">+=</span> <span class="n">N</span> <span class="o">*</span> <span class="n">M</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>    <span class="k">if</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="k">return</span> <span class="n">total</span>  <span class="c1"># no periodic/full evals inside the loop</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="c1"># Periodic full evals occur when trial_num % (m+1) == 0, where trial_num runs 2..N+1</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>    <span class="n">periodic_fulls</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>    <span class="c1"># If 1 &lt;= N &lt; m, the code triggers one final full eval at the end</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="n">extra_final</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>    <span class="n">total</span> <span class="o">+=</span> <span class="p">(</span><span class="n">periodic_fulls</span> <span class="o">+</span> <span class="n">extra_final</span><span class="p">)</span> <span class="o">*</span> <span class="n">V</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>    <span class="k">return</span> <span class="n">total</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dspy.GEPA.compile" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="nb">compile</span><span class="p">(</span><span class="n">student</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">trainset</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Example</span><span class="p">],</span> <span class="n">teacher</span><span class="p">:</span> <span class="n">Module</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">valset</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Example</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Module</span></code>

<a href="#dspy.GEPA.compile" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>GEPA uses the trainset to perform reflective updates to the prompt, but uses the valset for tracking Pareto scores.
If no valset is provided, GEPA will use the trainset for both.</p>
<p>Parameters:
- student: The student module to optimize.
- trainset: The training set to use for reflective updates.
- valset: The validation set to use for tracking Pareto scores. If not provided, GEPA will use the trainset for both.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dspy/teleprompt/gepa/gepa.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="k">def</span><span class="w"> </span><span class="nf">compile</span><span class="p">(</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>    <span class="n">student</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>    <span class="n">trainset</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Example</span><span class="p">],</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="n">teacher</span><span class="p">:</span> <span class="n">Module</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>    <span class="n">valset</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Example</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Module</span><span class="p">:</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">    GEPA uses the trainset to perform reflective updates to the prompt, but uses the valset for tracking Pareto scores.</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">    If no valset is provided, GEPA will use the trainset for both.</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">    - student: The student module to optimize.</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">    - trainset: The training set to use for reflective updates.</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">    - valset: The validation set to use for tracking Pareto scores. If not provided, GEPA will use the trainset for both.</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">gepa</span><span class="w"> </span><span class="kn">import</span> <span class="n">GEPAResult</span><span class="p">,</span> <span class="n">optimize</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">dspy.teleprompt.gepa.gepa_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">DspyAdapter</span><span class="p">,</span> <span class="n">LoggerAdapter</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>    <span class="k">assert</span> <span class="n">trainset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Trainset must be provided and non-empty&quot;</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>    <span class="k">assert</span> <span class="n">teacher</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Teacher is not supported in DspyGEPA yet.&quot;</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auto</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_metric_calls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">auto_budget</span><span class="p">(</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>            <span class="n">num_preds</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">student</span><span class="o">.</span><span class="n">predictors</span><span class="p">()),</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>            <span class="n">num_candidates</span><span class="o">=</span><span class="n">AUTO_RUN_SETTINGS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">auto</span><span class="p">][</span><span class="s2">&quot;n&quot;</span><span class="p">],</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="n">valset_size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">valset</span><span class="p">)</span> <span class="k">if</span> <span class="n">valset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">trainset</span><span class="p">),</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="p">)</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_full_evals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_metric_calls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_full_evals</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">valset</span><span class="p">)</span> <span class="k">if</span> <span class="n">valset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_metric_calls</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Either auto, max_full_evals, or max_metric_calls must be set.&quot;</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running GEPA for approx </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_metric_calls</span><span class="si">}</span><span class="s2"> metric calls of the program. This amounts to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_metric_calls</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">valset</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">max_metric_calls</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">valset</span><span class="p">))</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> full evals on the </span><span class="si">{</span><span class="s1">&#39;train&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">valset</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;train+val&#39;</span><span class="si">}</span><span class="s2"> set.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>    <span class="k">if</span> <span class="n">valset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No valset provided; Using trainset as valset. This is useful as an inference-time scaling strategy where you want GEPA to find the best solutions for the provided tasks in the trainset, as it makes GEPA overfit prompts to the provided trainset. In order to ensure generalization and perform well on unseen tasks, please provide separate trainset and valset. Provide the smallest valset that is just large enough to match the downstream task distribution, while keeping trainset as large as possible.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>    <span class="n">valset</span> <span class="o">=</span> <span class="n">valset</span> <span class="ow">or</span> <span class="n">trainset</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">valset</span><span class="p">)</span><span class="si">}</span><span class="s2"> examples for tracking Pareto scores. You can consider using a smaller sample of the valset to allow GEPA to explore more diverse solutions within the same budget. GEPA requires you to provide the smallest valset that is just large enough to match your downstream task distribution, while providing as large trainset as possible.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>    <span class="n">rng</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">Random</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">feedback_fn_creator</span><span class="p">(</span><span class="n">pred_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">predictor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PredictorFeedbackFn&quot;</span><span class="p">:</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">feedback_fn</span><span class="p">(</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>            <span class="n">predictor_output</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>            <span class="n">predictor_inputs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>            <span class="n">module_inputs</span><span class="p">:</span> <span class="n">Example</span><span class="p">,</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>            <span class="n">module_outputs</span><span class="p">:</span> <span class="n">Prediction</span><span class="p">,</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>            <span class="n">captured_trace</span><span class="p">:</span> <span class="s2">&quot;DSPyTrace&quot;</span><span class="p">,</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ScoreWithFeedback&quot;</span><span class="p">:</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>            <span class="n">trace_for_pred</span> <span class="o">=</span> <span class="p">[(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">predictor_inputs</span><span class="p">,</span> <span class="n">predictor_output</span><span class="p">)]</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>            <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metric_fn</span><span class="p">(</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>                <span class="n">module_inputs</span><span class="p">,</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>                <span class="n">module_outputs</span><span class="p">,</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>                <span class="n">captured_trace</span><span class="p">,</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>                <span class="n">pred_name</span><span class="p">,</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>                <span class="n">trace_for_pred</span><span class="p">,</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>            <span class="p">)</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="s2">&quot;feedback&quot;</span><span class="p">):</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>                <span class="k">if</span> <span class="n">o</span><span class="p">[</span><span class="s2">&quot;feedback&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>                    <span class="n">o</span><span class="p">[</span><span class="s2">&quot;feedback&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;This trajectory got a score of </span><span class="si">{</span><span class="n">o</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>                <span class="k">return</span> <span class="n">o</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>                <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">score</span><span class="o">=</span><span class="n">o</span><span class="p">,</span> <span class="n">feedback</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;This trajectory got a score of </span><span class="si">{</span><span class="n">o</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>        <span class="k">return</span> <span class="n">feedback_fn</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>    <span class="n">feedback_map</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>        <span class="n">k</span><span class="p">:</span> <span class="n">feedback_fn_creator</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">student</span><span class="o">.</span><span class="n">named_predictors</span><span class="p">()</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>    <span class="p">}</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>    <span class="c1"># Build the DSPy adapter that encapsulates evaluation, trace capture, feedback extraction, and instruction proposal</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>    <span class="n">adapter</span> <span class="o">=</span> <span class="n">DspyAdapter</span><span class="p">(</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="n">student_module</span><span class="o">=</span><span class="n">student</span><span class="p">,</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>        <span class="n">metric_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metric_fn</span><span class="p">,</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>        <span class="n">feedback_map</span><span class="o">=</span><span class="n">feedback_map</span><span class="p">,</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>        <span class="n">failure_score</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">failure_score</span><span class="p">,</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>        <span class="n">num_threads</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_threads</span><span class="p">,</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="n">add_format_failure_as_feedback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">add_format_failure_as_feedback</span><span class="p">,</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>        <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">,</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>        <span class="n">reflection_lm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reflection_lm</span><span class="p">,</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>        <span class="n">custom_instruction_proposer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_instruction_proposer</span><span class="p">,</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="n">warn_on_score_mismatch</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">warn_on_score_mismatch</span><span class="p">,</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>        <span class="n">reflection_minibatch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reflection_minibatch_size</span><span class="p">,</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>    <span class="p">)</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>    <span class="c1"># Instantiate GEPA with the simpler adapter-based API</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>    <span class="n">base_program</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">pred</span><span class="o">.</span><span class="n">signature</span><span class="o">.</span><span class="n">instructions</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">student</span><span class="o">.</span><span class="n">named_predictors</span><span class="p">()}</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>    <span class="n">gepa_result</span><span class="p">:</span> <span class="n">GEPAResult</span> <span class="o">=</span> <span class="n">optimize</span><span class="p">(</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>        <span class="n">seed_candidate</span><span class="o">=</span><span class="n">base_program</span><span class="p">,</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>        <span class="n">trainset</span><span class="o">=</span><span class="n">trainset</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>        <span class="n">valset</span><span class="o">=</span><span class="n">valset</span><span class="p">,</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>        <span class="n">adapter</span><span class="o">=</span><span class="n">adapter</span><span class="p">,</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>        <span class="c1"># Reflection-based configuration</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>        <span class="n">reflection_lm</span><span class="o">=</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">reflection_lm</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reflection_lm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>        <span class="n">candidate_selection_strategy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">candidate_selection_strategy</span><span class="p">,</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>        <span class="n">skip_perfect_score</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_perfect_score</span><span class="p">,</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="n">reflection_minibatch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reflection_minibatch_size</span><span class="p">,</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>        <span class="n">module_selector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">component_selector</span><span class="p">,</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>        <span class="n">perfect_score</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">perfect_score</span><span class="p">,</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>        <span class="c1"># Merge-based configuration</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>        <span class="n">use_merge</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_merge</span><span class="p">,</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>        <span class="n">max_merge_invocations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_merge_invocations</span><span class="p">,</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>        <span class="c1"># Budget</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>        <span class="n">max_metric_calls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_metric_calls</span><span class="p">,</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>        <span class="c1"># Logging</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>        <span class="n">logger</span><span class="o">=</span><span class="n">LoggerAdapter</span><span class="p">(</span><span class="n">logger</span><span class="p">),</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>        <span class="n">run_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="p">,</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>        <span class="n">use_wandb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_wandb</span><span class="p">,</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>        <span class="n">wandb_api_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">wandb_api_key</span><span class="p">,</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>        <span class="n">wandb_init_kwargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">wandb_init_kwargs</span><span class="p">,</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>        <span class="n">use_mlflow</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_mlflow</span><span class="p">,</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>        <span class="n">track_best_outputs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">track_best_outputs</span><span class="p">,</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>        <span class="n">display_progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>        <span class="n">raise_on_exception</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>        <span class="c1"># Reproducibility</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>        <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">gepa_kwargs</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>    <span class="p">)</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>    <span class="n">new_prog</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="n">build_program</span><span class="p">(</span><span class="n">gepa_result</span><span class="o">.</span><span class="n">best_candidate</span><span class="p">)</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_stats</span><span class="p">:</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>        <span class="n">dspy_gepa_result</span> <span class="o">=</span> <span class="n">DspyGEPAResult</span><span class="o">.</span><span class="n">from_gepa_result</span><span class="p">(</span><span class="n">gepa_result</span><span class="p">,</span> <span class="n">adapter</span><span class="p">)</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="n">new_prog</span><span class="o">.</span><span class="n">detailed_results</span> <span class="o">=</span> <span class="n">dspy_gepa_result</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>    <span class="k">return</span> <span class="n">new_prog</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dspy.GEPA.get_params" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_params</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></code>

<a href="#dspy.GEPA.get_params" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the parameters of the teleprompter.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The parameters of the teleprompter.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dspy/teleprompt/teleprompt.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Get the parameters of the teleprompter.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        The parameters of the teleprompter.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><p>:::</p>
<!-- END_API_REF -->

<p>GEPAの核心的な特徴の一つは、ドメイン固有のテキスト形式フィードバックを効果的に活用できる点にある。ユーザーはGEPAの評価指標としてフィードバック関数を提供する必要があり、この関数は以下の呼び出し規約に従う必要がある：</p>
<!-- START_API_REF -->


<div class="doc doc-object doc-class">



<h2 id="dspy.teleprompt.gepa.gepa.GEPAFeedbackMetric" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>dspy.teleprompt.gepa.gepa.GEPAFeedbackMetric</code>


<a href="#dspy.teleprompt.gepa.gepa.GEPAFeedbackMetric" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Protocol">Protocol</span></code></p>













  <div class="doc doc-children">








<h3 id="dspy.teleprompt.gepa.gepa.GEPAFeedbackMetric-functions">Functions<a href="#dspy.teleprompt.gepa.gepa.GEPAFeedbackMetric-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="dspy.teleprompt.gepa.gepa.GEPAFeedbackMetric.__call__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">gold</span><span class="p">:</span> <span class="n">Example</span><span class="p">,</span> <span class="n">pred</span><span class="p">:</span> <span class="n">Prediction</span><span class="p">,</span> <span class="n">trace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DSPyTrace</span><span class="p">],</span> <span class="n">pred_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">pred_trace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DSPyTrace</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">ScoreWithFeedback</span><span class="p">]</span></code>

<a href="#dspy.teleprompt.gepa.gepa.GEPAFeedbackMetric.__call__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>This function is called with the following arguments:
- gold: The gold example.
- pred: The predicted output.
- trace: Optional. The trace of the program's execution.
- pred_name: Optional. The name of the target predictor currently being optimized by GEPA, for which 
    the feedback is being requested.
- pred_trace: Optional. The trace of the target predictor's execution GEPA is seeking feedback for.</p>
<p>Note the <code>pred_name</code> and <code>pred_trace</code> arguments. During optimization, GEPA will call the metric to obtain
feedback for individual predictors being optimized. GEPA provides the name of the predictor in <code>pred_name</code>
and the sub-trace (of the trace) corresponding to the predictor in <code>pred_trace</code>.
If available at the predictor level, the metric should return dspy.Prediction(score: float, feedback: str) corresponding 
to the predictor.
If not available at the predictor level, the metric can also return a text feedback at the program level
(using just the gold, pred and trace).
If no feedback is returned, GEPA will use a simple text feedback consisting of just the score: 
f"This trajectory got a score of {score}."</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dspy/teleprompt/gepa/gepa.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="n">gold</span><span class="p">:</span> <span class="n">Example</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">pred</span><span class="p">:</span> <span class="n">Prediction</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">trace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;DSPyTrace&quot;</span><span class="p">],</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">pred_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="n">pred_trace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;DSPyTrace&quot;</span><span class="p">],</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="s2">&quot;ScoreWithFeedback&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    This function is called with the following arguments:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    - gold: The gold example.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    - pred: The predicted output.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    - trace: Optional. The trace of the program&#39;s execution.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    - pred_name: Optional. The name of the target predictor currently being optimized by GEPA, for which </span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        the feedback is being requested.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    - pred_trace: Optional. The trace of the target predictor&#39;s execution GEPA is seeking feedback for.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    Note the `pred_name` and `pred_trace` arguments. During optimization, GEPA will call the metric to obtain</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    feedback for individual predictors being optimized. GEPA provides the name of the predictor in `pred_name`</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    and the sub-trace (of the trace) corresponding to the predictor in `pred_trace`.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    If available at the predictor level, the metric should return dspy.Prediction(score: float, feedback: str) corresponding </span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    to the predictor.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    If not available at the predictor level, the metric can also return a text feedback at the program level</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    (using just the gold, pred and trace).</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    If no feedback is returned, GEPA will use a simple text feedback consisting of just the score: </span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    f&quot;This trajectory got a score of {score}.&quot;</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><p>:::</p>
<!-- END_API_REF -->

<p><code>track_stats=True</code>が設定されている場合、GEPAは提案された全ての候補について詳細な結果と最適化実行時のメタデータを返却する。これらの結果はGEPAによって最適化されたプログラムの<code>detailed_results</code>属性に格納され、以下の型を持つ：</p>
<!-- START_API_REF -->


<div class="doc doc-object doc-class">



<h2 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>              <code class="highlight language-python"><span class="n">dspy</span><span class="o">.</span><span class="n">teleprompt</span><span class="o">.</span><span class="n">gepa</span><span class="o">.</span><span class="n">gepa</span><span class="o">.</span><span class="n">DspyGEPAResult</span><span class="p">(</span><span class="n">candidates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Module</span><span class="p">],</span> <span class="n">parents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]],</span> <span class="n">val_aggregate_scores</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">val_subscores</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="n">per_val_instance_best_candidates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span> <span class="n">discovery_eval_counts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">best_outputs_valset</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Prediction</span><span class="p">]]]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">total_metric_calls</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">num_full_val_evals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">



        <p>Additional data related to the GEPA run.</p>
<p>Fields:
- candidates: list of proposed candidates (component_name -&gt; component_text)
- parents: lineage info; for each candidate i, parents[i] is a list of parent indices or None
- val_aggregate_scores: per-candidate aggregate score on the validation set (higher is better)
- val_subscores: per-candidate per-instance scores on the validation set (len == num_val_instances)
- per_val_instance_best_candidates: for each val instance t, a set of candidate indices achieving the best score on t
- discovery_eval_counts: Budget (number of metric calls / rollouts) consumed up to the discovery of each candidate</p>
<ul>
<li>total_metric_calls: total number of metric calls made across the run</li>
<li>num_full_val_evals: number of full validation evaluations performed</li>
<li>log_dir: where artifacts were written (if any)</li>
<li>
<p>seed: RNG seed for reproducibility (if known)</p>
</li>
<li>
<p>best_idx: candidate index with the highest val_aggregate_scores</p>
</li>
<li>best_candidate: the program text mapping for best_idx</li>
</ul>











  <div class="doc doc-children">





<h3 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult-attributes">Attributes<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult-attributes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-attribute">



<h4 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult.candidates" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">candidates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Module</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult.candidates" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult.parents" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">parents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult.parents" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult.val_aggregate_scores" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">val_aggregate_scores</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult.val_aggregate_scores" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult.val_subscores" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">val_subscores</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult.val_subscores" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult.per_val_instance_best_candidates" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">per_val_instance_best_candidates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult.per_val_instance_best_candidates" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult.discovery_eval_counts" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">discovery_eval_counts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult.discovery_eval_counts" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult.best_outputs_valset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">best_outputs_valset</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Prediction</span><span class="p">]]]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult.best_outputs_valset" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult.total_metric_calls" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">total_metric_calls</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult.total_metric_calls" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult.num_full_val_evals" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">num_full_val_evals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult.num_full_val_evals" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult.log_dir" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult.log_dir" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult.seed" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult.seed" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult.best_idx" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">best_idx</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult.best_idx" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult.best_candidate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">best_candidate</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult.best_candidate" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult.highest_score_achieved_per_val_task" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">highest_score_achieved_per_val_task</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult.highest_score_achieved_per_val_task" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>


<h3 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult-functions">Functions<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult.to_dict" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">to_dict</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></code>

<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult.to_dict" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dspy/teleprompt/gepa/gepa.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="n">cands</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">cand</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="p">]</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="n">candidates</span><span class="o">=</span><span class="n">cands</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="n">parents</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parents</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="n">val_aggregate_scores</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">val_aggregate_scores</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="n">best_outputs_valset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">best_outputs_valset</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">val_subscores</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">val_subscores</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">per_val_instance_best_candidates</span><span class="o">=</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">per_val_instance_best_candidates</span><span class="p">],</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">discovery_eval_counts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">discovery_eval_counts</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">total_metric_calls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">total_metric_calls</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">num_full_val_evals</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_full_val_evals</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="n">log_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">best_idx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">best_idx</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dspy.teleprompt.gepa.gepa.DspyGEPAResult.from_gepa_result" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">from_gepa_result</span><span class="p">(</span><span class="n">gepa_result</span><span class="p">:</span> <span class="n">GEPAResult</span><span class="p">,</span> <span class="n">adapter</span><span class="p">:</span> <span class="n">DspyAdapter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DspyGEPAResult</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#dspy.teleprompt.gepa.gepa.DspyGEPAResult.from_gepa_result" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dspy/teleprompt/gepa/gepa.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="k">def</span><span class="w"> </span><span class="nf">from_gepa_result</span><span class="p">(</span><span class="n">gepa_result</span><span class="p">:</span> <span class="s2">&quot;GEPAResult&quot;</span><span class="p">,</span> <span class="n">adapter</span><span class="p">:</span> <span class="s2">&quot;DspyAdapter&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DspyGEPAResult&quot;</span><span class="p">:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="k">return</span> <span class="n">DspyGEPAResult</span><span class="p">(</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="n">candidates</span><span class="o">=</span><span class="p">[</span><span class="n">adapter</span><span class="o">.</span><span class="n">build_program</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">gepa_result</span><span class="o">.</span><span class="n">candidates</span><span class="p">],</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">parents</span><span class="o">=</span><span class="n">gepa_result</span><span class="o">.</span><span class="n">parents</span><span class="p">,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="n">val_aggregate_scores</span><span class="o">=</span><span class="n">gepa_result</span><span class="o">.</span><span class="n">val_aggregate_scores</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">best_outputs_valset</span><span class="o">=</span><span class="n">gepa_result</span><span class="o">.</span><span class="n">best_outputs_valset</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="n">val_subscores</span><span class="o">=</span><span class="n">gepa_result</span><span class="o">.</span><span class="n">val_subscores</span><span class="p">,</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="n">per_val_instance_best_candidates</span><span class="o">=</span><span class="n">gepa_result</span><span class="o">.</span><span class="n">per_val_instance_best_candidates</span><span class="p">,</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="n">discovery_eval_counts</span><span class="o">=</span><span class="n">gepa_result</span><span class="o">.</span><span class="n">discovery_eval_counts</span><span class="p">,</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">total_metric_calls</span><span class="o">=</span><span class="n">gepa_result</span><span class="o">.</span><span class="n">total_metric_calls</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">num_full_val_evals</span><span class="o">=</span><span class="n">gepa_result</span><span class="o">.</span><span class="n">num_full_val_evals</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="n">log_dir</span><span class="o">=</span><span class="n">gepa_result</span><span class="o">.</span><span class="n">run_dir</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">seed</span><span class="o">=</span><span class="n">gepa_result</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><p>:::</p>
<!-- END_API_REF -->

<h2 id="_1">使用例<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>GEPAの使用例については、<a href="../../../../tutorials/gepa_ai_program/">GEPAチュートリアル</a>を参照されたい。</p>
<h3 id="_2">推論時検索機能<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>GEPAはテスト時/推論時の検索メカニズムとしても機能する。<code>valset</code>を評価用バッチに設定し、<code>track_best_outputs=True</code>を指定することで、GEPAは各バッチ要素に対して、進化的探索プロセス中に発見された最高スコアの出力を生成する。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">gepa</span> <span class="o">=</span> <span class="n">dspy</span><span class="o">.</span><span class="n">GEPA</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span> <span class="n">track_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">new_prog</span> <span class="o">=</span> <span class="n">gepa</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">student</span><span class="p">,</span> <span class="n">trainset</span><span class="o">=</span><span class="n">my_tasks</span><span class="p">,</span> <span class="n">valset</span><span class="o">=</span><span class="n">my_tasks</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">各タスクにおける達成最高スコア</span> <span class="o">=</span> <span class="n">new_prog</span><span class="o">.</span><span class="n">detailed_results</span><span class="o">.</span><span class="n">highest_score_achieved_per_val_task</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">最適出力結果</span> <span class="o">=</span> <span class="n">new_prog</span><span class="o">.</span><span class="n">detailed_results</span><span class="o">.</span><span class="n">best_outputs_valset</span>
</code></pre></div>
<h2 id="gepa">GEPAの動作原理<a class="headerlink" href="#gepa" title="Permanent link">&para;</a></h2>
<h3 id="1">1. <strong>内省的プロンプト変異</strong><a class="headerlink" href="#1" title="Permanent link">&para;</a></h3>
<p>GEPAはLLMを用いて、構造化された実行トレース（入力データ、出力結果、失敗事例、フィードバック情報）について内省を行い、指定されたモジュールを対象に、実際に観測された失敗事例や詳細なテキスト／環境フィードバックに基づいて、新たな指示文やプログラムコードを提案します。</p>
<h3 id="2">2. <strong>最適化信号としての豊富なテキストフィードバック</strong><a class="headerlink" href="#2" title="Permanent link">&para;</a></h3>
<p>GEPAは、単なるスカラー報酬だけでなく、利用可能なあらゆるテキスト形式のフィードバックを活用できます。これには評価ログ、コード実行履歴、構文解析失敗事例、制約条件違反、エラーメッセージ文字列、さらには特定のサブモジュールに特化した個別フィードバックも含まれます。これにより、ドメイン知識を考慮した実用的な最適化が可能となります。</p>
<h3 id="3">3. <strong>パレート最適に基づく候補選択</strong><a class="headerlink" href="#3" title="Permanent link">&para;</a></h3>
<p>GEPAは、単に「最良の」グローバル候補を進化させる手法（局所最適解や停滞を招く可能性がある）ではなく、パレート最適集合（少なくとも1つの評価事例において最高スコアを達成する候補群）を維持します。各反復処理では、このパレートフロンティアから（網羅率に比例する確率で）次の変異対象候補をサンプリングし、探索と補完的な戦略の堅牢な保持を両立させます。</p>
<h3 id="_3">アルゴリズムの概要<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>初期候補プール</strong>として、最適化前のプログラムを設定します。</li>
<li><strong>反復処理</strong>：</li>
<li><strong>パレートフロンティアから候補をサンプリング</strong>します。</li>
<li><strong>訓練データセットからミニバッチをサンプリング</strong>します。</li>
<li><strong>ミニバッチに対するモジュール実行トレースとフィードバックを収集</strong>します。</li>
<li><strong>対象モジュールを選定</strong>し、重点的な改善を行います。</li>
<li><strong>LLMによる内省：</strong> 収集したフィードバックを活用し、対象モジュール向けの新たな指示文／プロンプトを反射的メタプロンプティングによって提案します。</li>
<li><strong>新規候補をミニバッチに適用</strong>し、<strong>改善が確認された場合はパレート検証セットで評価</strong>を行います。</li>
<li><strong>候補プール／パレートフロンティアを更新</strong>します。</li>
<li><strong>[オプション]システム認識型のマージ／交叉操作</strong>：異なる系統から最も性能の高いモジュールを統合します。</li>
<li><strong>ロールアウトまたは評価指標の予算が枯渇するまで</strong>処理を継続します。</li>
<li><strong>検証セットにおける総合性能が最も高い候補を出力</strong>します。</li>
</ol>
<h2 id="_4">フィードバック指標の実装方法<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<p>適切に設計された評価指標は、GEPAのサンプル効率と学習信号の豊富さにおいて極めて重要です。GEPAでは、指標が<code>dspy.Prediction(score=..., feedback=...)</code>形式の出力を返すことを想定しています。GEPAはLLMベースのワークフローから得られる自然言語形式のトレースを最適化に活用し、中間的な実行軌跡やエラー情報を数値報酬に変換することなく平易なテキスト形式で保持します。これは人間の診断プロセスを模倣するものであり、システムの挙動やボトルネックをより明確に特定することを可能にします。</p>
<p>GEPAに適したフィードバックを実装するための実践的ガイドライン：</p>
<ul>
<li><strong>既存の成果物の活用</strong>：ログデータ、単体テスト結果、評価スクリプト、プロファイラ出力などを活用します。これらを可視化するだけで十分な場合が多いです。</li>
<li><strong>成果物の分解分析</strong>：スコアを各評価項目（正確性、応答遅延、コスト、安全性など）ごとに分解し、エラー発生箇所を工程ごとに特定します。</li>
<li><strong>処理過程の可視化</strong>：パイプラインの各工程にラベル付けを行い、通過/不合格の判定結果とともに、特に重要なエラー（例えばコード生成パイプラインにおけるエラーなど）を報告します。</li>
<li><strong>検証チェックによる根拠付け</strong>：自動検証ツール（単体テスト、スキーマ検証、シミュレータなど）を使用するか、検証が困難なタスクについてはLLMを判定者として活用します（PUPAプロジェクトの手法参照）。</li>
<li><strong>明確性の優先</strong>：技術的複雑さよりも、エラー網羅率と意思決定ポイントの明確化に重点を置きます。</li>
</ul>
<h3 id="_5">具体例<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>文書検索タスク</strong>（例：HotpotQA）：単なるRecall/F1スコアだけでなく、正しく取得された文書、誤った文書、未取得の文書を個別に列挙します。</li>
<li><strong>多目的最適化タスク</strong>（例：PUPA）：総合スコアを各評価項目ごとに分解し、各目的関数の寄与度を明らかにすることで、品質とプライバシー保護などのトレードオフ関係を可視化します。</li>
<li><strong>積層型パイプライン</strong>（例：コード生成パイプライン：構文解析→コンパイル→実行→プロファイリング→評価）：各工程における個別の失敗箇所を可視化します。LLMによる自己修正の場合、自然言語によるトレース情報のみで十分な場合が多いです。</li>
</ul>
<h2 id="_6">カスタム指示提案機能の提案<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<p>GEPAの指示提案メカニズムを高度にカスタマイズする場合、カスタム指示提案者やコンポーネント選択機能の実装については、<a href="../GEPA_Advanced/">高度な機能</a>のセクションを参照してください。</p>
<h2 id="_7">関連資料<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://arxiv.org/abs/2507.19457">GEPA論文：arxiv:2507.19457</a></li>
<li><a href="https://github.com/gepa-ai/gepa">GEPA GitHubリポジトリ</a> - <code>dspy.GEPA</code>オプティマイザで使用されているGEPAのコア進化パイプラインが収録されています。</li>
<li><a href="../../../../tutorials/gepa_ai_program/">DSPyチュートリアル</a></li>
</ul>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../../modules/Refine/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Refine">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Refine
              </div>
            </div>
          </a>
        
        
          
          <a href="../GEPA_Advanced/" class="md-footer__link md-footer__link--next" aria-label="Next: 2. GEPA Advanced">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                2. GEPA Advanced
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2025 <a href="https://github.com/stanfordnlp"  target="_blank" rel="noopener">DSPy</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/stanfordnlp/dspy" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://discord.gg/XCGy2WDCQB" target="_blank" rel="noopener" title="discord.gg" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": ["navigation.tabs", "navigation.path", "navigation.indexes", "navigation.expand", "toc.follow", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy", "navigation.footer", "content.action.edit"], "search": "../../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../../../js/runllm-widget.js"></script>
      
        <script src="../../../../js/tutorial-nav.js"></script>
      
    
  </body>
</html>